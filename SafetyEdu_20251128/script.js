(async function () {
  const answerDB = {
    爆炸是所有化学危险品的一个重要性质: ["错误"],
    烘箱等加热设备内不准烘烤易燃易爆试剂及易燃物品: ["正确"],
    "发生各类案件时应立即报案，妥善保护案发现场，若有人受伤，在救人时应尽可能记住现场破坏前的情况（如手机拍照等）":
      ["正确"],
    "当有人发生触电事故时，应马上直接将其拉开": ["错误"],
    "烘箱（干燥箱）在加热时，门可以开启": ["错误"],
    "实验室高温电加热设备使用过程中必须有专人负责监控和合理调节,离开时要切断电源":
      ["正确"],
    "运转中的机械设备对人的伤害主要有撞伤、压伤、轧伤、卷缠等": ["正确"],
    "电气设施应防爆，避雷装置接地良好": ["正确"],
    "烘箱等加热设备内不准烘烤易燃易爆试剂及易燃物品;不使用塑料筐等易燃容器盛放实验物品在烘箱等加热设备内烘烤":
      ["正确"],
    "发生车辆着火时，应立即用灭火器向起火点处喷射灭火，火势不可控制时人员应马上撤离，并迅速报警":
      ["正确"],
    "大型仪器使用中,应注意仪器设备的接地、电磁辐射、网络等安全事项,避免事故发生":
      ["正确"],
    "实验室使用超过15年的烘箱、马弗炉等出故障后,私自找专业人员维修后可以继续使用":
      ["错误"],
    "实验室内电源根据需要可自行拆装、改线": ["错误"],
    "实验室安全与卫生工作应坚持“安全第一,预防为主”的原则": ["正确"],
    "在室外灭火时，应站在上风位置": ["正确"],
    "实验中遇到严重割伤,可在伤口上部合适位置处用干净的纱布扎紧,减慢流血,并立即送医院":
      ["正确"],
    "如遇呼吸道吸进有毒气体、蒸气、烟雾而引起呼吸系统中毒时，应立即将病人移至室外空气新鲜的地方，解开衣领，使之温暖和安静，切勿随便进行人工呼吸":
      ["正确"],
    干燥箱和恒温箱的使用温度不能超过最高允许温度: ["正确"],
    "使用危险化学品单位应当制定本单位事故应急救援预案,配备应急救援人员和必要的应急救援器材、设备,并定期组织演练":
      ["正确"],
    "实验室的紧急洗眼器或紧急喷淋装置,在安全使用到期后,即使全新或重未使用,也应该及时更换和安装新品":
      ["正确"],
    "涉及化学品的实验室不使用明火电炉。如必须使用，须有安全防范措施": ["正确"],
    实验室的空试剂瓶可以作为普通垃圾直接丢弃在楼道垃圾桶内: ["错误"],
    "身边有人严重触电，应当首先切断电源，然后进行紧急抢救如人工呼吸，并立即拨打急救电话120":
      ["正确"],
    "初次进入实验室的操作人员应了解实验室具体的潜在危险,认真阅读、理解安全手册和操作手册":
      ["正确"],
    "触电紧急救护时，首先应使触电者脱离电源，然后立即进行人工呼吸": ["正确"],
    "实验室安装有视频监控为了确保实验过程安全和做好防盗辅助,有利于发生事故后进行原因查找,但实验室属于个科研场所,因科研保密需要,实验室人员可以私自将摄像头拆除或遮挡":
      ["错误"],
    "冲压小的零部件时，应使用专用夹具装卸工件，不得把手伸进模具内": ["正确"],
    "相对湿度越大，静电越强": ["错误"],
    "实验研究过程中购置易制毒试剂、易制爆试剂等手续麻烦,为了简化程序,可自行到化学试剂市场上自行购置并使用":
      ["错误"],
    "储存在冰箱内的所有容器,应当清楚地标明内装物品的品名、储存日期和储存者的姓名":
      ["正确"],
    "要加强实验室排污处理装置(系统)的建设和管理,做到达标排放。实验废弃物不得倒入自来水下水道或普通垃圾箱等处":
      ["正确"],
    "在高校实验室内禁止吸烟,但是在实验室的走廊内或厕所等地方允许吸烟": ["错误"],
    容器的电器开关和熔断器不需要设置在明显位置: ["错误"],
    电工作业时应穿防静电鞋: ["错误"],
    "爆炸是指物质瞬间突然发生物理或化学变化，同时释放出大量的气体和能量（光能、热能、机械能）并伴有巨大声响的现象":
      ["正确"],
    "在剪切作业时，光线强度，湿度变化都能影响作业的安全": ["正确"],
    "发现有人触电，应立即切断电源，不能直接拉触电者，应用木棒或其它绝缘物将人与带电体分离":
      ["正确"],
    "在作业场所液化气浓度较高时，应该佩戴（ ）": ["呼吸面罩"],
    "泡沫灭火器的外壳用薄钢板制成,内有一个玻璃胆,其中盛有硫酸铝,胆外装有碳酸氢钠溶液和发泡剂。灭火液由50份硫酸铝和50份碳酸氢钠及5份发泡剂组成。使用时将灭火器倒置震荡后,立即发生化学反应生成含CO2的泡沫。此泡沫黏附在燃烧物表面上,通过在燃烧物表面形成与空气隔绝的薄层而达到灭火目的。它适用于扑灭实验室中发生的一般火灾,但不适用于下列哪种火灾事故":
      ["电线老化短路起火"],
    焊接冷裂纹是____产生的裂纹: ["焊缝冷却后"],
    "雷电放电具有（ ）的特点": ["电流大，电压高"],
    "灭火毯，或称消防被、灭火被、防火毯、消防毯、阻燃毯、逃生毯，是由玻璃纤维等材料经过特殊处理编织而成的织物,能起到隔离热源及火焰的作用，可用于扑灭小范围液体容器着火或者小面积可以覆灭的火源，也可在火灾发生时现场人员披覆在身上逃生。下列哪种火灾情况发生时应该使用灭火毯":
      ["少量可燃液体倾倒后引发初期火灾"],
    "下列哪种伤害不属于机械伤害的范围?()": ["红眼病"],
    "下面做法错误的是（ ）": ["发现高压电线落地立即用干木棍支起来"],
    "化学品的毒性可以通过皮肤吸收、消化道吸收及呼吸道吸收等三种方式对人体健康产生危害,下列不正确的预防措施是":
      ["实验过程中使用三氯甲烷时戴防尘口罩"],
    "易燃化学试剂理想存放温度是多少？允许存放最高室温不得超过多少？": [
      "-4～4℃，30℃",
    ],
    "压力容器在正常运行中，其顶部的压力是（ ）": ["工作压力"],
    "手用工具不应放在工作台边缘是因为()": ["工具易于坠落伤人"],
    "5千瓦的三相交流电机，满负荷工作时其线电流是（ ）": ["3A左右"],
    "使用离心机时操作错误的是（ ）": ["少量样品时不需要考虑离心管的对角平衡"],
    "特种设备出现故障或者发生异常情况时，应当（ ）": [
      "停止使用，并对其进行全面检查，消除安全隐患",
    ],
    "工作台上、机床上使用的局部照明灯，电压一般不得超过多少伏？": ["36伏"],
    "火灾中对人员威胁最大的是?": ["烟气"],
    "学校对危险化学废物的处理实行（ ）的工作原则": [
      "分类收集、定点存放、专人管理、集中处理",
    ],
    "异常带电是指（ ）": ["通常是指“漏电”"],
    "金属钠着火可采用的灭火方式有（ ）。": ["干砂"],
    "静电的电量虽然不大,但其放电时产生的静电火花有可能引起爆炸和火灾,比较常见的是放电时瞬间的电流造成精密实验仪器损坏,不正确的预防措施有":
      ["在易产生静电的场所梳理头发"],
    "引起电器线路火灾的原因是（ ）": ["其他都是"],
    "把玻璃管或温度计插入橡皮塞或软木塞时,常常会折断而使人受伤。下列不正确的操作方法是":
      ["无需润滑,且操作时与双手距离无关"],
    "车间内的插座距地面的高度一般不低于（ ）。": ["0．3米"],
    "关于化学品的使用、管理,下列说法哪个是错误的": [
      "有机溶剂可以置于普通冰箱保存",
    ],
    "在使用设备时，如果发现设备工作异常，应（ ）": ["停机并报告相关负责人员"],
    "使用电气设备时，由于维护不及时，当（ ）进入时，可导致短路事故": [
      "导电粉尘或纤维",
    ],
    "严禁在化验室内存放总量大于（ ）体积的瓶装易燃液体。": ["20L"],
    "实验室仪器设备用电或线路发生故障着火时，应立即（ ），并组织人员用灭火器进行灭火":
      ["切断现场电源"],
    "《气瓶安全监察规程》规定气瓶的最高使用温度为多少度？": ["60"],
    "为了保证在故障条件下形成故障电流回路，从而提供自动切断条件，保护导体在使用中是____的":
      ["不允许中断"],
    "四孔的三相电源插座上没有（ ）。": ["地线"],
    "实验大楼安全出口的疏散门应（ ）": ["向外开启"],
    "生产、经营、储存、运输、使用危险化学品和处置废弃危险化学品的单位，其（ ）必须保证本单位危险化学品的安全管理符合有关法律、法规、规章的规定和国家标准，并对本单位危险化学品的安全负责。":
      ["主要负责人"],
    "学生实验安全意识的形成要求实验者坚持“三不伤害”原则,此处的“三不伤害”原则是（ ）":
      ["不伤害自己、不伤害他人、不被他人伤害"],
    实验室常用灭火器是存放和使用错误的表述为: [
      "为了防止灭火器丢失,各实验室负责人应该将灭火器箱放入有锁的实验柜内",
    ],
    "实验室各种管理规章制度应该（ ）": ["上墙或便于取阅的地方"],
    "在用起重机械至少（）进行一次日常维护保养和自行检查，并作记录;": ["每月"],
    "三孔插座上（ ）孔是火线。": ["右下"],
    "用酒精灯时，以下（ ）操作是正确的": [
      "灭灯时要用灯帽盖灭",
      "点火时要用火柴点",
    ],
    "使用不了解的化学药品前应做好的准备有（ ）": [
      "了解这种药品对人体的侵入途径和危险特性及中毒后的急救措施",
      "明确这种药品在实验中的作用",
      "了解这种药品的毒性及防护措施",
      "掌握这种药品的物理性质和化学性质",
    ],
    "摩擦是产生静电一种主要原因，尤其在干燥的环境中，人体的活动和物体的移动都会产生很强的静电，静电在突然释放的时候会对人体或设备造成损伤。下列选项中防止静电事故的主要办法有（ ）":
      [
        "增加空气中的湿度，降低静电产生的条件",
        "人体接触对静电敏感设备时提前释放自己身体中积累的电荷，例如带静电防护手环、使用静电防护毯",
        "用电设备都良好接地",
        "在重要场合铺设防静电地板",
      ],
    "影响混合物爆炸极限的因素有（ ）": [
      "混合物的含氧量",
      "混合物的温度",
      "容器的大小",
      "混合物的压力",
    ],
    "进入公共场所，应注意细心观察场所的疏散情况，记住（ ）以利于发生火灾情况下紧急疏散":
      ["进出口位置", "安全出口位置", "疏散通道楼梯的方位"],
    "实验完成后离开实验室时应进行检查（ ）": [
      "关闭房间内所有水源",
      "观察房间内是否还有灯亮",
      "切断房间内所有电源",
      "静听房间内有无声音",
    ],
    "过氧化苯甲酸、五氧化二磷等强氧化剂，在适当条件下可放出氧发生爆炸，在使用这类强氧化性化学试剂时，应注意（ ）":
      [
        "环境温度不要高于30℃",
        "不要加热",
        "不要与有机物或还原性物质共同使用",
        "通风要良好",
      ],
    "过氧化酸、硝酸铵、硝酸钾、高氯酸及其盐、重铬酸及其盐、高锰酸及其盐、过氧化苯甲酸、五氧化二磷等强氧化剂，在适当条件下可放出氧发生爆炸，在使用这类强氧化性化学试剂时，应注意（ ）":
      [
        "不要与有机物或还原性物质共同使用",
        "环境温度不要高于30℃",
        "不要加热",
        "通风要良好",
      ],
    "运行中的电气设备包括（ ）": [
      "全部带有电压的电气设备",
      "一部分带有电压的电气设备",
      "一经操作即有电压的电气设备",
    ],
    "关于重铬酸钾洗液，下列陈述正确的是（ ）": [
      "捞出器皿后，立即放进清洗杯，避免洗液滴落在洗液缸外等处。然后马上用水连同手套一起清洗",
      "避免用手在洗液缸里取放器皿的时间过长，即便戴上了专用手套",
    ],
    "压力容器按工作温度区分（低温、常温、高温）时分为（ ）": [
      "-20摄氏度<常温容器<450摄氏度",
      "高温容器≥450摄氏度",
      "低温容器≤-20摄氏度",
    ],
    "关于安全用电，下列做法错误的是（ ）": [
      "在电线上晾晒衣物",
      "用铁丝代替保险丝",
    ],
    "正确使用气体钢瓶的原则是（ ）": [
      "打开钢瓶总阀门，此时高压表显示出瓶内贮气总压力",
      "慢慢地顺时针转动调压手柄，至低压表显示出实验所需压力为止",
      "停止使用时，先关闭总阀门，待减压阀中余气逸尽后，再关闭减压阀",
      "在钢瓶上装上配套的减压阀。检查减压阀是否关紧，方法是逆时针旋转调压手柄至螺杆松动为止",
    ],
    "在下列选项中，电气火灾的火源主要有（ ）": [
      "电火花",
      "电热器（如电炉、热得快等）",
      "电热高温（在导体中的大电流、或电磁材料中的磁损耗、或绝缘介质中的电损耗产生的热量导致的高温）",
    ],
    "实验中用到很多玻璃器皿，容易破碎，为避免造成割伤应该注意（ ）": [
      "装配仪器时用力处远离连接部位",
      "装配仪器时用力过猛或装配不当",
      "玻璃折断面未烧圆滑，有棱角",
      "仪器口径不合而勉强连接",
    ],
    "电褥子是用电热线和普通棉纺织布做成的，如果使用不当很容易发生火灾，使用中应注意（ ）":
      [
        "不可长期通电使用",
        "不可用水洗",
        "不可折叠使用",
        "不可在弹性和伸缩性较大的床上使用",
      ],
    "实验室发生紧急事故时，正确的应对策略是（ ）": [
      "听从指挥",
      "如被困室内（电梯内），应设法呼救",
      "发生小型着火事故，应防止火势蔓延（采取切断电源、移走易燃物品、灭火等措施）",
      "发生大的突发事故后，人身安全才是最重要的，事故现场人员首先应尽快有序地从安全通道撤离，等事故得到控制之后再回来处理其他事情",
    ],
    "实验室安全包括（ ）": ["用电", "使用设备", "防盗", "防火"],
    "火灾蔓延的途径有（ ）": ["热传导", "热辐射", "热对流"],
    "发生电器火灾时可以使用的灭火设备包括（ ）": [
      "二氧化碳灭火器",
      "干粉灭火器",
    ],
    "关于烘箱、电阻炉等加热设备须制定安全操作规程，以下说法正确的是（ ）": [
      "使用加热设备时，温度较高的实验需有人值守或有实时监控措施",
      "使用电阻炉等明火设备时有人值守",
      "使用烘箱完毕，清理物品、切断电源，确认其冷却至安全温度后方能离开",
    ],
    "使用电钻或手持电动工具时应注意的安全问题有（ ）": [
      "电机进线应装有接地或接零的装置",
      "在使用时，必须穿绝缘鞋",
      "所有的导电部分必须有良好的绝缘",
      "戴绝缘手套等防护用品",
      "每次使用工具时，都必须严格检查",
      "所有的导线必须是坚韧耐用的软胶皮线,在导线进入电机的壳体处，应用胶皮圈加以保护，以防电线的绝缘层被磨损",
    ],
    "关于氧气瓶的使用，以下说法正确的是（ ）": [
      "氧气瓶附件有缺损，阀门螺杆滑丝时，应停止使用",
      "氧气瓶不能强烈碰撞，禁止采用抛、摔及其它容易引起撞击的方法进行装卸或搬运",
      "氧气瓶不得靠近热源，与明火的距离一般不得小于10米",
      "操作者的双手、手套及工具等不得沾染油脂",
    ],
    "发生火灾拨通“119”后，应向“119”台报告（ ），并派人到适当位置迎接消防车到来":
      ["人员被困情况", "火灾详细地点", "火势大小", "燃烧物质及受影响的物质"],
    "下列描述中，正确安全使用台灯的有（ ）": [
      "远离可燃物",
      "灯泡功率不得超过60瓦",
      "不能用纸做灯罩",
    ],
  };

  console.log("loading: " + Object.keys(answerDB).length + " questions");
  function sleep(ms) {
    return new Promise((resolve) => setTimeout(resolve, ms));
  }

  function norm(str) {
    if (!str) return "";
    let s = str
      .trim()
      .replace(/^[\(（]分数[:：]\d+[\)）]/, "")
      .replace(/^\d+[.、\s]*/, "")
      .replace(/^[A-F][.、\s]*/i, "")
      .replace(/[\s,，。;；!！?？、:：]/g, "");
    s = s.replace(/～/g, "-").replace(/．/g, ".");
    return s.toLowerCase();
  }

  function getNums(str) {
    return (str.match(/-?\d+(\.\d+)?/g) || []).map(Number);
  }

  let matchCount = 0;
  const subjects = document.querySelectorAll(".subject");

  for (const subjectDiv of subjects) {
    let clone = subjectDiv.cloneNode(true);
    clone
      .querySelectorAll(".num, .score, .doubtful")
      .forEach((e) => e.remove());
    let qRaw = clone.innerText || clone.textContent;

    let qKey = norm(qRaw);
    let answers = answerDB[qKey];

    if (!answers) {
      for (let k in answerDB) {
        let dbKey = norm(k);
        if (
          (dbKey.includes(qKey) || qKey.includes(dbKey)) &&
          dbKey.length > 5
        ) {
          answers = answerDB[k];
          break;
        }
      }
    }

    if (answers) {
      matchCount++;
      let root = subjectDiv.parentElement;
      let opts = root.querySelectorAll(
        ".ant-radio-wrapper, .ant-checkbox-wrapper",
      );
      if (opts.length === 0) opts = root.querySelectorAll("li");
      let clickedIndices = new Set();

      for (let i = 0; i < opts.length; i++) {
        let opt = opts[i];
        let oRaw = opt.innerText || opt.textContent;
        let oKey = norm(oRaw);
        let oNums = getNums(oRaw);

        let isCorrect = false;

        for (let ans of answers) {
          let ansKey = norm(ans);
          let ansNums = getNums(ans);

          if (ansNums.length > 0 && oNums.length > 0) {
            if (JSON.stringify(ansNums) === JSON.stringify(oNums)) {
              isCorrect = true;
              break;
            }
            continue;
          }

          if (ansKey === oKey) {
            isCorrect = true;
            break;
          }

          if (ansKey.includes(oKey) && ansKey.length > oKey.length) {
            let diff = ansKey.replace(oKey, "");
            if (
              diff.includes("不") ||
              diff.includes("非") ||
              diff.includes("无")
            ) {
              continue;
            }
            isCorrect = true;
            break;
          }
        }

        if (isCorrect) {
          let input = opt.querySelector("input");
          let isChecked = false;
          if (
            opt.classList.contains("ant-radio-wrapper-checked") ||
            opt.classList.contains("ant-checkbox-wrapper-checked")
          )
            isChecked = true;
          if (input && input.checked) isChecked = true;

          if (!isChecked && !clickedIndices.has(i)) {
            clickedIndices.add(i);
            if (input) input.click();
            else opt.click();
            await sleep(50);
          }
        }
      }
      subjectDiv.style.backgroundColor = "#f6ffed";
    } else {
      subjectDiv.style.backgroundColor = "#fff1f0";
    }
  }
  alert("finished");
})();
